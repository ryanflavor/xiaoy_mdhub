#!/bin/bash
# vnpy ç³»ç»Ÿä¾èµ–å®‰è£…è„šæœ¬ - Ubuntu 24.04
# å®‰è£… vnpy_ctp å’Œ vnpy_sopt æ‰€éœ€çš„ C++ ç¼–è¯‘ç¯å¢ƒ

set -e

echo "ğŸ”§ ä¸º Ubuntu 24.04 å®‰è£… vnpy ç³»ç»Ÿä¾èµ–..."
echo "vnpy_ctp å’Œ vnpy_sopt æ˜¯é¡¹ç›®è¡Œæƒ…æºçš„å¿…éœ€ç»„ä»¶"

# æ›´æ–°åŒ…ç®¡ç†å™¨
echo "ğŸ“¦ æ›´æ–°åŒ…ç®¡ç†å™¨..."
sudo apt-get update

# å®‰è£… C++ ç¼–è¯‘å™¨å’Œæ„å»ºå·¥å…·
echo "ğŸ“¦ å®‰è£… C++ ç¼–è¯‘å™¨å’Œæ„å»ºå·¥å…·..."
sudo apt-get install -y \
    build-essential \
    gcc \
    g++ \
    cmake \
    ninja-build \
    pkg-config \
    python3-dev \
    python3-pip \
    python3-venv

# å®‰è£… Boost åº“ï¼ˆvnpy_ctp çš„å…³é”®ä¾èµ–ï¼‰
echo "ğŸ“¦ å®‰è£… Boost åº“..."
sudo apt-get install -y \
    libboost-all-dev \
    libboost-python-dev \
    libboost-system-dev \
    libboost-thread-dev \
    libboost-locale-dev \
    libboost-date-time-dev \
    libboost-chrono-dev \
    libboost-atomic-dev

# å®‰è£…å…¶ä»–å¿…éœ€çš„ç³»ç»Ÿåº“
echo "ğŸ“¦ å®‰è£…å…¶ä»–å¿…éœ€åº“..."
sudo apt-get install -y \
    git \
    curl \
    libtool \
    autoconf \
    automake

# éªŒè¯å®‰è£…
echo "âœ… éªŒè¯å®‰è£…..."
echo "GCC: $(gcc --version | head -n1)"
echo "G++: $(g++ --version | head -n1)"
echo "CMake: $(cmake --version | head -n1)"
echo "Python: $(python3 --version)"

echo ""
echo "ğŸ‰ Ubuntu 24.04 ç³»ç»Ÿä¾èµ–å®‰è£…å®Œæˆï¼"
echo ""
echo "ç°åœ¨å¯ä»¥å®‰è£… vnpy å¿…éœ€ç»„ä»¶:"
echo "  npm run install:vnpy"
echo "æˆ–æ‰‹åŠ¨å®‰è£…:"
echo "  pip install --upgrade pip setuptools wheel"
echo "  pip install vnpy vnpy_ctp vnpy_sopt"